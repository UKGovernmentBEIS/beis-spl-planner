{% from "summary-list/macro.njk" import govukSummaryList %}
{% from "inset-text/macro.njk" import govukInsetText %}
{% from "../components/leave-block-summary.njk" import leaveBlockSummary %}
{% from "../components/file-download.njk" import fileDownload %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <p>
      This is a summary of your leave plan.
      It shows your leave dates, when you need to notify your employer and how you can apply.
    </p>

    {{ govukSummaryList({
      rows: [
        {
          key: {
            text: "Baby is due" if data | isBirth else "Placement date"
          },
          value: {
            text: data | startDay | formatForDisplay
          }
        }
      ]
    }) }}

    <h2 class="govuk-heading-l">
      {{ data | primaryName | capitalize }}'s leave dates
    </h2>
    <h3 class="govuk-heading-m">
      {{ data | primaryLeaveType | capitalize }} leave
    </h3>

    {{ leaveBlockSummary({
      name: data | primaryLeaveType | capitalize + " leave",
      block: leaveBlocks['primary'][0],
      data: data,
      notify: {
        date: data | startDay | offsetWeeks(-15),
        explanation: "15 weeks before " + data | startDateName
      }
    }) }}

    <h4 class="govuk-heading-s">
      How to give notice
    </h4>
    <p>
      Tell your employer when the baby is due and when you want to start your maternity leave.
      Your employer can ask for this in writing.
      Your employer must write to you within 28 days confirming your start and end dates.
    </p>
    <h4 class="govuk-heading-s">
      Changing your plans
    </h4>
    <p>
      You must give 28 days notice to your employer if you want to change your maternity leave dates.
    </p>

    <h3 class="govuk-heading-m">
      Shared parental leave ({{ data | primaryName }})
    </h3>
    {% for block in leaveBlocks['primary'] %}
      {% if not loop.first %}
        {{ leaveBlockSummary({
          name: "Block " + loop.index0,
          block: block,
          data: data,
          notify: {
            date: data | startDay | offsetWeeks(block.start) | offsetWeeks(-8),
            explanation: "8 weeks before block starts"
          }
        }) }}
      {% endif %}
    {% endfor %}
    <h4 class="govuk-heading-s">
      How to give notice
    </h4>
    <p>
{# TODO fix the href of this link#}
      Complete the Mother's SPL and ShPP notice form and submite it to the mother's employer 8 weeks before you want to start shared parental leave.
    </p>
    {# TODO add content to fileDownload macro #}
    {% set primaryNoticeDescription %}
      <p>This form has been prefilled with your chosen leave dates. If you prefer you can <a href="#">download a blank version</a>.
    {% endset %}

    {% set primaryNoticeDetails %}
      <p>This file may not be suitable for users of assistive technology. <a href="#">Request an accesible format</a>.
    {% endset %}

    {{ fileDownload({
      name: (data | primaryName | capitalize) + "'s SPL and ShPP notice form",
      href: "#",
      description: {
        html: primaryNoticeDescription
      },
      details: {
        html: primaryNoticeDetails
      }
    }) }}

    <h4 class="govuk-heading-s">
      Changing your plans
    </h4>
    <p>
      After you give notice you have two weeks to agree your shared parental leave dates with your employer.
    </p>
    <p>
      To change your dates after this you must give notice again 8 weeks before your first block of shared parental leave starts.
    </p>

    <h2 class="govuk-heading-l">
      {{ data | secondaryName | capitalize }}'s leave dates
    </h2>
    <h3 class="govuk-heading-m">
      Paternity leave
    </h3>

    {{ leaveBlockSummary({
      name: "Paternity leave",
      block: leaveBlocks['secondary'][0],
      data: data,
      notify: {
        date: data | startDay | offsetWeeks(-15),
        explanation: "15 weeks before due date"
      }
    }) }}

    <h4 class="govuk-heading-s">
      How to give notice
    </h4>
    <p>
{# TODO check this form link #}
      Use <a href="https://public-online.hmrc.gov.uk/lc/content/xfaforms/profiles/forms.html?contentRoot=repository:///Applications/PersonalTax_iForms/1.0/SC3&template=SC3.xdp" target="_blank">form SC3</a> to apply to your employer for Statutory Paternity Pay (SPP) and Leave.
    </p>

    <h4 class="govuk-heading-s">
      Changing your plans
    </h4>
    <p>
      You must give 28 days notice to your employer if you want to change your paternity leave dates.
    </p>

    <h3 class="govuk-heading-m">
      Shared parental leave ({{ data | secondaryName }})
    </h3>
    {% for block in leaveBlocks['secondary'] %}
      {% if not loop.first %}
        {{ leaveBlockSummary({
          name: "Block " + loop.index0,
          block: block,
          data: data,
          notify: {
            date: data | startDay | offsetWeeks(block.start) | offsetWeeks(-8),
            explanation: "8 weeks before block starts",
            asterisk: loop.length > 2
          }
        }) }}
      {% endif %}
    {% endfor %}
    <h4 class="govuk-heading-s">
      How to give notice
    </h4>
    <p>
      Complete the Partner's SPL and ShPP notice form and submit it to the partner's employer 8 weeks before you want to start shared parental leave.
    </p>
    {{ fileDownload({
      name: data | secondaryName | capitalize + "â€˜s SPL and ShPP notice form",
      href: "#",
      description: {
        html: primaryNoticeDescription
      },
      details: {
        html: primaryNoticeDetails
      }
    }) }}
    <h4 class="govuk-heading-s">
      Changing your plans
    </h4>
    <p>
      After you give notice you have two weeks to agree your shared parental laeve dates with your employer.
    </p>
    <p>
      To change you dates after this you must give notice again 8 weeks before your first block of shared parental leave starts.
    </p>
{# TODO where are these buttons going #}
    <button class="govuk-button" onclick="alert('Printing is coming soon.')">Print this plan</button>
    <button class="govuk-button" onclick="alert('Share links will be available soon.')">Share this page</button>
  </div>
</div>

